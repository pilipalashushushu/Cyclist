function init(){$.get("./php/CYShop.php",{},function(t){let e=[];!function(){let i=t.length,r=Math.round(i/8)+1;e=r}(),new Vue({el:"#prodRender",data:{searchbar:"",prodList:t,prodAmount:t.length,prodListTitle:"全部商品",pagesBtn:e,pagesBtnIsFirst:!0,isShop:1,nowPsn:0,nowProd:{}},methods:{orderOnChange(e){switch(parseInt(e.target.value)){case 0:this.prodList=t,this.prodAmount=t.length;break;case 1:this.prodList=order(t,"prodPrice"),this.prodAmount=this.prodList.length;break;case 2:this.prodList=order(t,"prodPrice",1),this.prodAmount=this.prodList.length;break;default:console.log(`onchange | ${e.target.value}`)}},pageIsActive(t){$(t.target).parent().children().removeClass("pages_active"),$(t.target).addClass("pages_active")},buttonFilter(t,e,i,r){this.prodList=t.filter(t=>t[e]==i),this.prodAmount=this.prodList.length,this.prodListTitle=r,this.isShop=1},onMoun(){this.buttonFilter(t,"prodType",1,"登山車")},onRoad(){this.buttonFilter(t,"prodType",2,"公路車")},onCity(){this.buttonFilter(t,"prodType",3,"城市車")},decor(){this.buttonFilter(t,"prodType",6,"保養品及消耗品")},colorBlack(){this.buttonFilter(t,"prodColor","黑","黑色")},colorWhite(){this.buttonFilter(t,"prodColor","白","白色")},colorRed(){this.buttonFilter(t,"prodColor","紅","紅色")},colorBlue(){this.buttonFilter(t,"prodColor","藍","藍色")},onAll(){this.prodList=t.filter(t=>1==t.prodType||2==t.prodType||3==t.prodType),this.prodAmount=this.prodList.length,this.isShop=1},searching(){""!=this.searchbar?(this.prodList=t.filter(t=>-1!=t.prodName.toLowerCase().indexOf(this.searchbar.toLowerCase())),this.prodListTitle=`關鍵字(${this.searchbar})`):(this.prodList=t,this.prodListTitle="全部商品"),this.prodAmount=this.prodList.length,this.isShop=1},showProd(e){this.nowPsn=localStorage.nowPsn,this.nowProd=t.slice(this.nowPsn-1,this.nowPsn),this.isShop=2,$(window).scrollTop("0")},leaveProd(){this.isShop=1},prodFold(t){let e=$(t.target);e.parent().find(":not(.prodfolder, .prodfolder i)").toggle("fold"),e.find("i").hasClass("fa-arrow-circle-o-down")?(e.find("i").removeClass("fa-arrow-circle-o-down"),e.find("i").addClass("fa-arrow-circle-o-up")):(e.find("i").removeClass("fa-arrow-circle-o-up"),e.find("i").addClass("fa-arrow-circle-o-down"))}},computed:{topPrice(){let t=0;for(var e=0;e<this.prodAmount;e++)parseInt(this.prodList[e].prodPrice)>t&&(t=parseInt(this.prodList[e].prodPrice));return t},lessPrice(){let t=999999;for(var e=0;e<this.prodAmount;e++)parseInt(this.prodList[e].prodPrice)<t&&(t=parseInt(this.prodList[e].prodPrice));return t}}})},"json"),Vue.component("prod-component",{props:["detail","name","price","img","index"],methods:{emitShop(t){let e;e=$(t.target).hasClass("prod")?$(t.target).find(".prodpsn").attr("psn"):$(t.target).parents(".prod").find(".prodpsn").attr("psn"),localStorage.nowPsn=e,this.$emit("is-in-shop",!1)},clickToAdd(t){let e=$(t.target).parent().next().attr("psn"),i=$(t.target).parent().prev().prev().prev().text(),r=$(t.target).parent().prev().text();if(sessionStorage["cart-list"]||(sessionStorage["cart-list"]=""),-1==sessionStorage["cart-list"].split(",").indexOf(e)){sessionStorage["cart-list"]+=`${e},`,sessionStorage[`cart-row-${e}`]=`${i},${r.slice(1,r.length)},1`;let o=$(t.target).parents(".prod").clone();o.offset().left;o.css({position:"absolute",width:$(t.target).parents(".prod").width(),height:$(t.target).parents(".prod").height(),zIndex:9999}),$(t.target).parent().next().append(o),TweenMax.fromTo(o,.6,{x:0,y:-30,scale:1,transformOrigin:"50% 50%"},{x:-o.offset().left+window.innerWidth-o.width()/2-120,y:-o.offset().top+$(window).scrollTop()-o.height()/2+30,scale:0,transformOrigin:"50% 50%",onComplete(){$(t.target).parent().next().empty()}})}},clickToFavor(t){let e=$(t.target).parent().next().attr("psn");if(sessionStorage["prod-favor"]||(sessionStorage["prod-favor"]=""),-1==sessionStorage["prod-favor"].split(",").indexOf(e)){sessionStorage["prod-favor"]+=`${e},`;let i=$(t.target).parents(".prod").clone();i.offset().left;i.css({position:"absolute",width:$(t.target).parents(".prod").width(),height:$(t.target).parents(".prod").height(),zIndex:9999}),$(t.target).parent().next().append(i),TweenMax.fromTo(i,.6,{x:0,y:-30,scale:1,transformOrigin:"50% 50%"},{x:-i.offset().left+window.innerWidth-i.width()/2-120,y:-i.offset().top+$(window).scrollTop()-i.height()/2+30,scale:0,transformOrigin:"50% 50%",onComplete(){$(t.target).parent().next().empty()}})}}},template:'\n            <li class="prod col-6 col-md-6" @click="emitShop">\n                <div class="prod-shell" style="position: relative;">\n                    <div class="prod-pic">\n                        <img :src="img">\n                    </div>\n                    <h3 class="prod-title">{{name}}</h3>\n                    <p class="prod-context">{{detail}}</p>\n                    <p class="prod-money">${{price}}</p>\n                    <div class="prodIcon">\n                        <p class="prod_like" @click.stop="clickToFavor"></p>\n                        <p class="prod_cart" @click.stop="clickToAdd"></p>\n                    </div>\n                    <div class="prodpsn" :psn="index" style="height: 0;position: absolute;top: 0;left: 0;"></div>\n                </div>\n            </li>\n        '}),Vue.component("prod-intro",{props:["img","price","type","name","detail","psn"],data(){return{typePsn:this.type,count:0}},computed:{typeTrans(){return 1==this.typePsn?"登山車":2==this.typePsn?"公路車":3==this.typePsn?"城市車":4==this.typePsn?"保養品":5==this.typePsn?"配件":void 0}},methods:{addToCart(t){let e=$(t.target).parent().prev().prev().prev().attr("psn"),i=$(t.target).parent().prev().prev().prev().text(),r=$(t.target).parent().prev().prev().text(),o=$(t.target).parent().prev().find(".prod-amount-show").text();console.log(e),sessionStorage["cart-list"]||(sessionStorage["cart-list"]=""),0!=o?-1==sessionStorage["cart-list"].split(",").indexOf(e)?(sessionStorage["cart-list"]+=`${e},`,sessionStorage[`cart-row-${e}`]=`${i},${r.slice(4,r.length)},${o}`):sessionStorage[`cart-row-${e}`]=`${i},${r.slice(4,r.length)},${o}`:alert("請填選購買數量")},addToFavor(t){console.log("addToFavor");let e=$(t.target).parent().prev().prev().prev().attr("psn");sessionStorage["prod-favor"]||(sessionStorage["prod-favor"]=""),-1==sessionStorage["prod-favor"].split(",").indexOf(e)&&(sessionStorage["prod-favor"]+=`${e},`)}},template:'\n            <div class="prod-info-m col-12 col-md-12">\n            <div class="prod-pic-group col-12">\n                <div class="prod-pic-main col-12 col-md-12">\n                    <img class="prod-pic-show" :src="img">\n                </div>\n                <div class="prod-pic-slider col-12">\n                    <div class="prod-pic-arrow col-md-1"></div>\n                    <div class="prod-pic-innerslider col-10">\n                        <div>\n                            <div :style="{\'backgroundImage\': \'url(./\' + img + \')\'}"></div>\n                            <div style="backgroundImage: url(\'./images/cyprod-sample-1.jpg\');"></div>\n                            <div style="backgroundImage: url(\'./images/cyprod-sample-2.jpg\');"></div>\n                            <div style="backgroundImage: url(\'./images/cyprod-sample-3.jpg\');"></div>\n                        </div>\n                    </div>\n                    <div class="prod-pic-arrow col-1"></div>\n                </div>\n            </div>\n            <div class="prod-intro">\n                <div class="center col-12">\n                    <div class="prod-intro-text col-12 col-md-7">\n                        <h2 class="prod-title">{{typeTrans}}</h2>\n                        <p class="prod-introCont">{{detail}}</p>\n                    </div>\n                    <div class="prod-intro-btns col-12 col-md-5">\n                        <h3 class="prod-name" :psn="psn">{{name}}</h3>\n                        <p class="prod-money">NT$ {{price}}</p>\n                        <ul>\n                            <li class="prod-amount-arrow" @click="count>0?count--:count"><i class="fa fa-minus" aria-hidden="true"></i></i>\n                            </li>\n                            <li class="prod-amount-show col-4">{{count}}</li>\n                            <li class="prod-amount-arrow" @click="count++;"><i class="fa fa-plus" aria-hidden="true"></i></i>\n                            </li>\n                        </ul>\n                        <div>\n                            <input type="button" class="prod-buy-join col-4 col-lg-10" value="加入購物車" @click="addToCart">\n                            <input type="button" class="prod-save col-5" value="加入收藏" @click="addToFavor">\n                        </div>\n                        <p>付款方式: 信用卡 <i class="fa fa-credit-card" aria-hidden="true"></i></p>\n                        <p>交貨方式: 貨運宅配 <i class="fa fa-car" aria-hidden="true"></i></p>\n                        <p>服務承諾: 提供統一發票或免用統一發票收據</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n        '}),Vue.component("prod-spec",{data:()=>({body:{"年度":2019,"車架":"GIANT ALUXX SL 輕量鋁合金車架","前叉":"GIANT 碳纖維前叉 (鋁合金 OverDrive Steerer)","前避震器":"N/A","尺寸":"XS(42.5), S(44.5), M(47), M / L(47.0)","顏色":"黑/紅"},ctrl:{"車把手":"GIANT Connect 鋁合金 31.8","車手豎桿":"GIANT 鋁合金"},spd:{"變速把手":"SHIMANO Tiagra","前變速器":"SHIMANO Tiagra","後變速器":"SHIMANO Tiagra","速別":"20"},brk:{"煞車把手":"SHIMANO TIAGRA","煞車組":"TEKTRO TKB177"},mve:{"大齒盤":"SHIMANO TIAGRA 50/34T","飛輪":"SHIMANO Tiagra 11-34T","鏈條":"KMC X10","腳踏":"WELLGO"},rtt:{"輪圈":"GIANT S-R2 支援無內胎外胎","花鼓":"GIANT S-R2","鋼絲":"GIANT S-R2","外胎":"GIANT GAVIA AC 2 700X25C WIRE TR"},oth:{"坐墊":"Giant Contact Forward","座管":"GIANT VARIANT 碳纖維"}}),template:'\n            <div>\n                <ul>車架系統\n                    <li v-for="(value, key) in body">\n                        <div>{{ key }}</div>\n                        <div>{{ value }}</div>\n                    </li>\n                </ul>\n                <ul>操控系統\n                    <li v-for="(value, key) in ctrl">\n                        <div>{{ key }}</div>\n                        <div>{{ value }}</div>\n                    </li>\n                </ul>\n                <ul>變速系統\n                    <li v-for="(value, key) in spd">\n                        <div>{{ key }}</div>\n                        <div>{{ value }}</div>\n                    </li>\n                </ul>\n                <ul>剎車系統\n                    <li v-for="(value, key) in brk">\n                        <div>{{ key }}</div>\n                        <div>{{ value }}</div>\n                    </li>\n                </ul>\n                <ul>傳動系統\n                    <li v-for="(value, key) in brk">\n                        <div>{{ key }}</div>\n                        <div>{{ value }}</div>\n                    </li>\n                </ul>\n                <ul>轉動系統\n                    <li v-for="(value, key) in rtt">\n                        <div>{{ key }}</div>\n                        <div>{{ value }}</div>\n                    </li>\n                </ul>\n                <ul>其他\n                    <li v-for="(value, key) in oth">\n                        <div>{{ key }}</div>\n                        <div>{{ value }}</div>\n                    </li>\n                </ul>\n            </div>\n        '}),Vue.component("price-slider",{props:["top","less"],template:'\n            <div style="margin-top: 20px;">\n                <div id="priceSlider"></div>\n                <p id="priceSliderNum" style="color: #fff; margin-top: 20px; float: right;">{{this.less}}</p>\n            </div>\n        ',mounted(){$(this.$el).slider({min:this.less,max:this.top,slide(t,e){$("#priceSliderNum").html(e.value)}}),bannerSlider()},beforeDestroy(){$(this.$el).slider("hide").slider("destroy")},methods:{emitPrice(){this.$emit("update")}},computed:{getNowPrice:()=>$("#priceSliderNum").html()}}),squareFix(),window.addEventListener("resize",function(){squareFix()},!1)}let order=function(t,e,i=0){let r=t.slice(),o=r.length;if(0==i){for(var n=0;n<o;n++)for(var s=0;s<o-1-n;s++)if(parseInt(r[s][e])>parseInt(r[s+1][e])){let t=r[s];r[s]=r[s+1],r[s+1]=t}}else for(n=0;n<o;n++)for(s=0;s<o-1-n;s++)if(parseInt(r[s][e])<parseInt(r[s+1][e])){let t=r[s];r[s]=r[s+1],r[s+1]=t}return r};function bannerSlider(){(new TimelineMax).to("#bannerRow",.3,{x:-$("#bannerRow").width()/3,delay:1.5}).to("#bannerRow",.3,{x:2*-$("#bannerRow").width()/3,delay:1.5}).to("#bannerRow",0,{x:0,delay:1.5,success:function(){setTimeout(bannerSlider,1.5)}})}function squareFix(){$(".square").css({height:$(".square").width()})}window.addEventListener("load",init,!1);