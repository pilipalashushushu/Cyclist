THREE.TGALoader=function(e){THREE.Loader.call(this,e)},THREE.TGALoader.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:THREE.TGALoader,load:function(e,a,r,o){var t=this,i=new THREE.Texture,s=new THREE.FileLoader(this.manager);return s.setResponseType("arraybuffer"),s.setPath(this.path),s.load(e,function(e){i.image=t.parse(e),i.needsUpdate=!0,void 0!==a&&a(i)},r,o),i},parse:function(e){var a=0,r=1,o=2,t=3,i=9,s=10,n=11,c=48,d=4,l=0,p=1,h=2,f=3;e.length<19&&console.error("THREE.TGALoader: Not enough data to contain header.");var E=new Uint8Array(e),g=0,T={id_length:E[g++],colormap_type:E[g++],image_type:E[g++],colormap_index:E[g++]|E[g++]<<8,colormap_length:E[g++]|E[g++]<<8,colormap_size:E[g++],origin:[E[g++]|E[g++]<<8,E[g++]|E[g++]<<8],width:E[g++]|E[g++]<<8,height:E[g++]|E[g++]<<8,pixel_size:E[g++],flags:E[g++]};!function(e){switch(e.image_type){case r:case i:(e.colormap_length>256||24!==e.colormap_size||1!==e.colormap_type)&&console.error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case o:case t:case s:case n:e.colormap_type&&console.error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case a:console.error("THREE.TGALoader: No data.");default:console.error('THREE.TGALoader: Invalid type "%s".',e.image_type)}(e.width<=0||e.height<=0)&&console.error("THREE.TGALoader: Invalid image size."),8!==e.pixel_size&&16!==e.pixel_size&&24!==e.pixel_size&&32!==e.pixel_size&&console.error('THREE.TGALoader: Invalid pixel size "%s".',e.pixel_size)}(T),T.id_length+g>e.length&&console.error("THREE.TGALoader: No data."),g+=T.id_length;var u=!1,m=!1,_=!1;switch(T.image_type){case i:u=!0,m=!0;break;case r:m=!0;break;case s:u=!0;break;case o:break;case n:u=!0,_=!0;break;case t:_=!0}var w="undefined"!=typeof OffscreenCanvas,v=w?new OffscreenCanvas(T.width,T.height):document.createElement("canvas");v.width=T.width,v.height=T.height;var y=v.getContext("2d"),b=y.createImageData(T.width,T.height),R=function(e,a,r,o,t){var i,s,n,c;if(s=r.pixel_size>>3,n=r.width*r.height*s,a&&(c=t.subarray(o,o+=r.colormap_length*(r.colormap_size>>3))),e){var d,l,p;i=new Uint8Array(n);for(var h=0,f=new Uint8Array(s);h<n;)if(l=1+(127&(d=t[o++])),128&d){for(p=0;p<s;++p)f[p]=t[o++];for(p=0;p<l;++p)i.set(f,h+p*s);h+=s*l}else{for(l*=s,p=0;p<l;++p)i[h+p]=t[o++];h+=l}}else i=t.subarray(o,o+=a?r.width*r.height:n);return{pixel_data:i,palettes:c}}(u,m,T,g,E);!function(e,a,r,o,t){var i,s,n,E,g,u;switch((T.flags&c)>>d){default:case h:i=0,n=1,g=a,s=0,E=1,u=r;break;case l:i=0,n=1,g=a,s=r-1,E=-1,u=-1;break;case f:i=a-1,n=-1,g=-1,s=0,E=1,u=r;break;case p:i=a-1,n=-1,g=-1,s=r-1,E=-1,u=-1}if(_)switch(T.pixel_size){case 8:!function(e,a,r,o,t,i,s,n){var c,d,l,p=0,h=T.width;for(l=a;l!==o;l+=r)for(d=t;d!==s;d+=i,p++)c=n[p],e[4*(d+h*l)+0]=c,e[4*(d+h*l)+1]=c,e[4*(d+h*l)+2]=c,e[4*(d+h*l)+3]=255}(e,s,E,u,i,n,g,o);break;case 16:!function(e,a,r,o,t,i,s,n){var c,d,l=0,p=T.width;for(d=a;d!==o;d+=r)for(c=t;c!==s;c+=i,l+=2)e[4*(c+p*d)+0]=n[l+0],e[4*(c+p*d)+1]=n[l+0],e[4*(c+p*d)+2]=n[l+0],e[4*(c+p*d)+3]=n[l+1]}(e,s,E,u,i,n,g,o);break;default:console.error("THREE.TGALoader: Format not supported.")}else switch(T.pixel_size){case 8:!function(e,a,r,o,t,i,s,n,c){var d,l,p,h=c,f=0,E=T.width;for(p=a;p!==o;p+=r)for(l=t;l!==s;l+=i,f++)d=n[f],e[4*(l+E*p)+3]=255,e[4*(l+E*p)+2]=h[3*d+0],e[4*(l+E*p)+1]=h[3*d+1],e[4*(l+E*p)+0]=h[3*d+2]}(e,s,E,u,i,n,g,o,t);break;case 16:!function(e,a,r,o,t,i,s,n){var c,d,l,p=0,h=T.width;for(l=a;l!==o;l+=r)for(d=t;d!==s;d+=i,p+=2)c=n[p+0]+(n[p+1]<<8),e[4*(d+h*l)+0]=(31744&c)>>7,e[4*(d+h*l)+1]=(992&c)>>2,e[4*(d+h*l)+2]=(31&c)>>3,e[4*(d+h*l)+3]=32768&c?0:255}(e,s,E,u,i,n,g,o);break;case 24:!function(e,a,r,o,t,i,s,n){var c,d,l=0,p=T.width;for(d=a;d!==o;d+=r)for(c=t;c!==s;c+=i,l+=3)e[4*(c+p*d)+3]=255,e[4*(c+p*d)+2]=n[l+0],e[4*(c+p*d)+1]=n[l+1],e[4*(c+p*d)+0]=n[l+2]}(e,s,E,u,i,n,g,o);break;case 32:!function(e,a,r,o,t,i,s,n){var c,d,l=0,p=T.width;for(d=a;d!==o;d+=r)for(c=t;c!==s;c+=i,l+=4)e[4*(c+p*d)+2]=n[l+0],e[4*(c+p*d)+1]=n[l+1],e[4*(c+p*d)+0]=n[l+2],e[4*(c+p*d)+3]=n[l+3]}(e,s,E,u,i,n,g,o);break;default:console.error("THREE.TGALoader: Format not supported.")}}(b.data,T.width,T.height,R.pixel_data,R.palettes);return y.putImageData(b,0,0),w?v.transferToImageBitmap():v}});